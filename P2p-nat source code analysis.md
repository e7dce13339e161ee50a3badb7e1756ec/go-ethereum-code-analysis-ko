NAT 네트워크 주소 변환을 의미한다. 소스 코드의이 부분은 더 독립적이고 단일, 여기에 분석되지. 우리는 라인의 기본 기능을 이해합니다.

NAT UPnP를 PMP 아래 두 네트워크 및 프로토콜.

### UPnP를 응용 프로그램 시나리오 (PMP는 비슷하며 UPnP를 프로토콜)

사용자가 NAT를 통해 인터넷에 연결되어 있지만 등 BC, 같은 이뮬 같은 이뮬의 P2P 소프트웨어의 사용을 필요로하는 경우, 다음 UPnP 기능은 매우 편리를 가져올 것이다. 자동 BC을 넣을 수는 UPnP를 사용하고, 이뮬 DianLuo 포트 번호가 공용 네트워크에 매핑 듣고, 공용 네트워크 사용자가 연결 NAT 개인 네트워크를 시작할 수 있도록.


주요 기능은 네트워크 라우터의 IP + 포트 인터페이스 IP + 포트 매핑을 제공하는 것이다. 공용 네트워크의 사용자가 간단하게 액세스 할 수 있도록이 프로그램은 네트워크 내에서 네트워크 외부의 IP 주소와 동일했다. 그렇지 않으면, 우리는이 방법으로 UDP 홀 펀칭에 액세스 할 필요가있다.



### UDP 프로토콜의 P2P

이제 대부분의 사용자 환경을 실행하는 네트워크 환경에 있습니다. 네트워크 환경에서 포트를 듣기 프로그램 다른 공용 네트워크에 직접 액세스 할 수 없습니다. 우리는 굴을 파기의 과정을 통해 이동해야합니다. 양측은 유니콤을 할 수 있습니다. 이것은 UDP 홀 펀칭이라고합니다.

![image](picture/nat_1.png)
직접 액세스 온라인 프로그램의 엑스트라 넷 희망은 달성 될 수 없다. 라우터는 방법은 네트워크 내에서 프로그램 경로 데이터에 모르기 때문에.

그래서 우리는 네트워크 내에서 프로그램에 의한 네트워크 외부의 첫 접촉, 그래서 라우터가 자동으로 네트워크 내에서 프로그램에 포트를 할당합니다. 그리고 내부의 매핑 192.168.1.1:3003 라우터를 기록 -&gt; 111.21.12.12:3003. 이 매핑 관계는 시간이 지남에 따라 나이, 결국 사라집니다.

![image](picture/nat_2.png)

일단 이러한 매핑 라우터를 설립했다. 인터넷에있는 다른 프로그램은 행복 방문 111.21.12.12:3003의 포트가 될 수 있습니다. 이 포트로 전송 된 모든 데이터가 결국 192.168.1.1:3003이 포트에 연결됩니다 때문입니다. 이것은내는 과정이라고합니다.

![image](picture/nat_3.png)




